<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>
<record id="view_move_form_inherit_dte" model="ir.ui.view">
    <field name="name">account.move.form.inherit.dte</field>
    <field name="model">account.move</field>
    <field name="inherit_id" ref="account.view_move_form"/>
    <field name="arch" type="xml">
        <xpath expr="//sheet/notebook" position="inside">
            <page name="dte_info" invisible="move_type != 'out_invoice'" string="Factura ElectrÃ³nica (DTE)">
                <group>
                 
                    <field name="gt_dte_auth_number" readonly="1"/>
                    <field name="gt_dte_numero" readonly="1"/>
                    <field name="gt_dte_serie" readonly="1"/>
                    <field name="gt_fecha_envio" readonly="1"/>
                    <field name="cancellation_reason"  invisible="cancellation_reason == False" />
                </group>
                <group>
                    <field name="gt_pdf_document" filename="numero_dte" widget="pdf_viewer"/>
                </group>
            </page>
        </xpath>
    </field>
</record>
     <record id="view_out_invoice_tree_inherit_estado_dte" model="ir.ui.view">
        <field name="name">account.out.invoice.tree.inherit.estado.dte</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_out_invoice_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='invoice_date_due']" position="after">
               <field name="gt_estado_dte"
                    widget="badge"
                    decoration-success="gt_estado_dte == 'Completado'"
                    decoration-warning="gt_estado_dte == 'Sin enviar'"
                    decoration-danger="gt_estado_dte == 'Cancelado'"
                    options="{'style': 'rounded'}"
                   
                   invisible="move_type != 'out_invoice'"/>
            </xpath>
        </field>
    </record>


    <record id="invoice_view_form" model="ir.ui.view">
            <field name="name">account_move_gt_inherit_form</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form" />
            <field name="arch" type="xml">
                <xpath expr="//button[@name='button_cancel']" position="after">
                    <button name="action_annul" type="object" string="Anular Factura"
                    invisible="(move_type not in ('out_invoice', 'out_refund')) or (state != 'posted')"
                    groups="account.group_account_invoice" class="btn btn-danger" />
           

                   

                </xpath>
                <xpath expr="//button[@name='button_draft']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                 <xpath expr="//button[@name='action_reverse']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                      <xpath expr="//button[@name='button_cancel']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//button[@name='action_post']" position="attributes">
                    <attribute name="string">Enviar Factura</attribute>
                </xpath>
                <xpath expr="//widget[@name='web_ribbon']" position="after">
                    <widget name="web_ribbon" title="Anulado" bg_color="bg-danger" invisible="state not in ('cancel')" />
                </xpath>
               
                   
             
            </field>
        </record>

  </data>
</odoo> 

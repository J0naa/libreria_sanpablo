<?xml version="1.0" encoding="utf-8"?>
<odoo>
<template id="report_invoice_billing_and_dte_block"
          inherit_id="account.report_invoice_document"
          priority="260">

    <!-- ===== CASO: address != shipping ===== -->
    <xpath expr="//div[@id='partner_vat_address_not_same_as_shipping']"
           position="replace">
        <t t-call="account.report_invoice_billing_block"/>
    </xpath>

    <!-- ===== CASO: address == shipping ===== -->
    <xpath expr="//div[@id='partner_vat_address_same_as_shipping']"
           position="replace">
        <t t-call="account.report_invoice_billing_block"/>
    </xpath>

    <!-- ===== CASO: sin shipping ===== -->
    <xpath expr="//div[@id='partner_vat_no_shipping']"
           position="replace">
        <t t-call="account.report_invoice_billing_block"/>
    </xpath>

</template>

<template id="account.report_invoice_billing_block">

    <div style="
        margin-top:8px;
        padding:10px 12px;
        background:#f5f7f8;
        border-left:4px solid var(--o-company-primary-color);
        font-size:12px;
        line-height:1.4;
    ">

        <!-- CLIENTE -->
        <div style="margin-bottom:6px;">
            <strong>Cliente:</strong>
            <span t-field="o.partner_id.name"/>
        </div>

        <div t-if="o.partner_id.vat" style="margin-bottom:6px;">
            <strong>NIT:</strong>
            <span t-field="o.partner_id.vat"/>
        </div>

        <hr style="margin:6px 0; border:none; border-top:1px solid #ddd;"/>

        <!-- DATOS DTE -->
        <t t-if="o.move_type == 'out_invoice'">
            <div style="margin-bottom:6px;">
                <strong>Factura Electrónica (DTE)</strong>
            </div>

            <div t-if="o.gt_dte_serie">
                <strong>Serie:</strong>
                <span t-esc="o.gt_dte_serie"/>
            </div>

            <div t-if="o.gt_dte_numero">
                <strong>Número:</strong>
                <span t-esc="o.gt_dte_numero"/>
            </div>

            <div t-if="o.gt_dte_auth_number">
                <strong>Autorización:</strong>
                <span t-esc="o.gt_dte_auth_number"/>
            </div>

            <div t-if="o.gt_fecha_envio">
                <strong>Fecha envío:</strong>
                <span t-esc="o.gt_fecha_envio"/>
            </div>

            <hr style="margin:6px 0; border:none; border-top:1px solid #ddd;"/>

            <!-- CERTIFICADOR -->
            <div>
                <strong>Certificador:</strong><br/>
                DIGIFACT SERVICIOS, SOCIEDAD ANÓNIMA<br/>
                <strong>NIT:</strong> 7745482-0
            </div>
        </t>

    </div>

</template>
</odoo>
